<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‹±è¯­å•è¯æŒ‘æˆ˜ (å¸¦éŸ³æ•ˆç‰ˆ)</title>
    <style>
        :root {
            --primary-color: #4CAF50;
            --wrong-color: #f44336;
            --bg-color: #e0f7fa;
            --text-color: #37474f;
            --accent-color: #00bcd4;
        }

        body {
            font-family: 'Comic Sans MS', 'Chalkboard SE', 'Segoe UI', sans-serif;
            background-color: var(--bg-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            user-select: none;
        }

        .score-board {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--text-color);
            background: white;
            padding: 10px 25px;
            border-radius: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            border: 3px solid var(--accent-color);
        }

        .game-container {
            text-align: center;
            width: 95%;
            max-width: 700px;
            background: rgba(255, 255, 255, 0.8);
            padding: 30px;
            border-radius: 30px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.05);
        }

        .emoji-display {
            font-size: 8rem;
            margin-bottom: 20px;
            position: relative;
            height: 160px;
            line-height: 160px;
            transition: transform 0.3s;
        }

        .success-mark {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            font-size: 10rem;
            color: var(--primary-color);
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            text-shadow: 3px 3px 6px rgba(255,255,255,0.8);
            pointer-events: none;
            z-index: 10;
        }

        .success-mark.show {
            transform: translate(-50%, -50%) scale(1);
            opacity: 1;
        }

        .word-container {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 12px;
            margin-bottom: 40px;
            min-height: 70px;
        }

        .letter-slot {
            width: 55px;
            height: 65px;
            border-bottom: 5px solid #555;
            font-size: 3rem;
            font-weight: bold;
            color: var(--text-color);
            display: flex;
            align-items: flex-end;
            justify-content: center;
            text-transform: uppercase;
        }

        .keyboard {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 12px;
            margin-bottom: 30px;
        }

        .key-btn {
            width: 55px;
            height: 55px;
            font-size: 1.8rem;
            font-weight: bold;
            background-color: white;
            border: 2px solid #cfd8dc;
            border-radius: 12px;
            cursor: pointer;
            box-shadow: 0 5px 0 #b0bec5;
            transition: all 0.1s;
            color: #455a64;
            position: relative;
        }

        .key-btn:active {
            transform: translateY(5px);
            box-shadow: none;
        }

        .key-btn.correct {
            background-color: #e8f5e9;
            border-color: var(--primary-color);
            color: var(--primary-color);
            box-shadow: 0 5px 0 #a5d6a7;
            pointer-events: none;
        }
        
        .key-btn.correct:active {
             box-shadow: none;
        }

        .key-btn.wrong {
            background-color: #ffebee;
            border-color: var(--wrong-color);
            color: #e0e0e0;
            pointer-events: none;
            box-shadow: none;
            transform: translateY(5px);
        }

        .key-btn.wrong::after {
            content: 'Ã—';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2.5rem;
            color: var(--wrong-color);
        }

        .next-btn {
            padding: 15px 40px;
            font-size: 1.4rem;
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 6px 10px rgba(0,0,0,0.2);
            transition: background-color 0.2s;
            font-family: inherit;
        }
        
        .next-btn:hover {
            background-color: #00acc1;
        }

        .next-btn.restart {
            background-color: #FF9800;
        }
        .next-btn.restart:hover {
            background-color: #F57C00;
        }

        .result-message {
            font-size: 2rem;
            color: var(--text-color);
            margin-bottom: 20px;
            display: none;
        }

        /* é™éŸ³å¼€å…³ (å¯é€‰) */
        .mute-btn {
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 1.5rem;
            background: white;
            border: 2px solid #ccc;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
    </style>
</head>
<body>

    <button class="mute-btn" id="muteBtn" onclick="toggleMute()">ğŸ”Š</button>

    <div class="score-board">
        â­ <span id="score">0</span> / <span id="totalRound">20</span>
    </div>

    <div class="game-container">
        <div class="emoji-display">
            <span id="emoji">â“</span>
            <div class="success-mark" id="successMark">âœ“</div>
        </div>
        
        <div class="result-message" id="resultMessage"></div>

        <div class="word-container" id="wordContainer"></div>

        <div class="keyboard" id="keyboard"></div>

        <div class="controls">
            <button class="next-btn" id="actionBtn" onclick="handleAction()">è·³è¿‡ â”</button>
        </div>
    </div>

    <script>
        // ==================== éŸ³æ•ˆç®¡ç† (Base64åµŒå…¥) ====================
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        let isMuted = false;

        // ä½¿ç”¨ç®€å•çš„åˆæˆéŸ³æ•ˆå‡½æ•°ï¼Œé¿å…å¼•å…¥å·¨å¤§çš„Base64å­—ç¬¦ä¸²ï¼Œä¿è¯åŠ è½½é€Ÿåº¦å’Œå…¼å®¹æ€§
        // è¿™ç§æ–¹å¼ä¸éœ€è¦ä¸‹è½½æ–‡ä»¶ï¼Œå®Œå…¨ç”±ä»£ç ç”Ÿæˆå£°éŸ³
        
        const sounds = {
            // 0. æ¸¸æˆå¼€å§‹/é‡æ–°å¼€å§‹ (æ¸…è„†çš„ä¸Šè¡ŒéŸ³)
            start: () => playTone(440, 'sine', 0.1, 0.1), 
            
            // 1. æŒ‰å¯¹å­—æ¯ (é«˜é¢‘çŸ­ä¿ƒçš„å®å£°)
            correct: () => playTone(880, 'sine', 0.05, 0.1),
            
            // 2. æŒ‰é”™å­—æ¯ (ä½é¢‘æ²‰é—·çš„å—¡å£°)
            wrong: () => playTone(150, 'sawtooth', 0.1, 0.2),
            
            // 3. ç­”å¯¹ä¸€é¢˜ (æˆåŠŸå’Œå¼¦)
            success: () => playMelody([523, 659, 784, 1046], 0.1),
            
            // 4. å®Œæˆä¸€è½® (èƒœåˆ©å·è§’)
            win: () => playMelody([523, 523, 523, 659, 784, 1046, 784, 1046], 0.15) 
        };

        // æ’­æ”¾å•éŸ³
        function playTone(freq, type, attack, decay) {
            if(isMuted) return;
            if(audioContext.state === 'suspended') audioContext.resume();

            const osc = audioContext.createOscillator();
            const gain = audioContext.createGain();

            osc.type = type;
            osc.frequency.value = freq;

            gain.gain.setValueAtTime(0, audioContext.currentTime);
            gain.gain.linearRampToValueAtTime(0.3, audioContext.currentTime + attack); // éŸ³é‡ä¸ç”¨å¤ªå¤§
            gain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + attack + decay);

            osc.connect(gain);
            gain.connect(audioContext.destination);

            osc.start();
            osc.stop(audioContext.currentTime + attack + decay);
        }

        // æ’­æ”¾æ—‹å¾‹
        function playMelody(notes, speed) {
            if(isMuted) return;
            notes.forEach((note, index) => {
                setTimeout(() => {
                    playTone(note, 'triangle', 0.05, speed);
                }, index * (speed * 1000));
            });
        }

        function toggleMute() {
            isMuted = !isMuted;
            document.getElementById('muteBtn').innerText = isMuted ? 'ğŸ”‡' : 'ğŸ”Š';
        }


        // ==================== é¢˜åº“ (100+) ====================
        const fullQuestionBank = [
            // Animals
            { emoji: 'ğŸ¶', word: 'DOG' }, { emoji: 'ğŸ±', word: 'CAT' }, { emoji: 'ğŸ­', word: 'MOUSE' },
            { emoji: 'ğŸ¹', word: 'HAMSTER' }, { emoji: 'ğŸ°', word: 'RABBIT' }, { emoji: 'ğŸ¦Š', word: 'FOX' },
            { emoji: 'ğŸ»', word: 'BEAR' }, { emoji: 'ğŸ¼', word: 'PANDA' }, { emoji: 'ğŸ¨', word: 'KOALA' },
            { emoji: 'ğŸ¯', word: 'TIGER' }, { emoji: 'ğŸ¦', word: 'LION' }, { emoji: 'ğŸ®', word: 'COW' },
            { emoji: 'ğŸ·', word: 'PIG' }, { emoji: 'ğŸ¸', word: 'FROG' }, { emoji: 'ğŸµ', word: 'MONKEY' },
            { emoji: 'ğŸ”', word: 'CHICKEN' }, { emoji: 'ğŸ§', word: 'PENGUIN' }, { emoji: 'ğŸ¦', word: 'BIRD' },
            { emoji: 'ğŸ¦†', word: 'DUCK' }, { emoji: 'ğŸ¦…', word: 'EAGLE' }, { emoji: 'ğŸ¦‰', word: 'OWL' },
            { emoji: 'ğŸ¦‡', word: 'BAT' }, { emoji: 'ğŸº', word: 'WOLF' }, { emoji: 'ğŸ´', word: 'HORSE' },
            { emoji: 'ğŸ¦„', word: 'UNICORN' }, { emoji: 'ğŸ', word: 'BEE' }, { emoji: 'ğŸ›', word: 'BUG' },
            { emoji: 'ğŸ¦‹', word: 'BUTTERFLY' }, { emoji: 'ğŸŒ', word: 'SNAIL' }, { emoji: 'ğŸ¢', word: 'TURTLE' },
            { emoji: 'ğŸ', word: 'SNAKE' }, { emoji: 'ğŸ³', word: 'WHALE' }, { emoji: 'ğŸ¬', word: 'DOLPHIN' },
            { emoji: 'ğŸŸ', word: 'FISH' }, { emoji: 'ğŸ™', word: 'OCTOPUS' }, { emoji: 'ğŸ¦ˆ', word: 'SHARK' },
            { emoji: 'ğŸ¦€', word: 'CRAB' }, { emoji: 'ğŸœ', word: 'ANT' }, { emoji: 'ğŸ˜', word: 'ELEPHANT' },
            { emoji: 'ğŸ¦’', word: 'GIRAFFE' }, { emoji: 'ğŸ¦“', word: 'ZEBRA' }, { emoji: 'ğŸ¦¢', word: 'SWAN' },

            // Food
            { emoji: 'ğŸ', word: 'APPLE' }, { emoji: 'ğŸ', word: 'PEAR' }, { emoji: 'ğŸŠ', word: 'ORANGE' },
            { emoji: 'ğŸ‹', word: 'LEMON' }, { emoji: 'ğŸŒ', word: 'BANANA' }, { emoji: 'ğŸ‰', word: 'WATERMELON' },
            { emoji: 'ğŸ‡', word: 'GRAPE' }, { emoji: 'ğŸ“', word: 'STRAWBERRY' }, { emoji: 'ğŸ’', word: 'CHERRY' },
            { emoji: 'ğŸ‘', word: 'PEACH' }, { emoji: 'ğŸ¥­', word: 'MANGO' }, { emoji: 'ğŸ', word: 'PINEAPPLE' },
            { emoji: 'ğŸ¥', word: 'KIWI' }, { emoji: 'ğŸ…', word: 'TOMATO' }, { emoji: 'ğŸŒ½', word: 'CORN' },
            { emoji: 'ğŸ¥•', word: 'CARROT' }, { emoji: 'ğŸ¥”', word: 'POTATO' }, { emoji: 'ğŸ', word: 'BREAD' },
            { emoji: 'ğŸ§€', word: 'CHEESE' }, { emoji: 'ğŸ¥š', word: 'EGG' }, { emoji: 'ğŸ¥©', word: 'MEAT' },
            { emoji: 'ğŸ”', word: 'BURGER' }, { emoji: 'ğŸ•', word: 'PIZZA' }, { emoji: 'ğŸŒ­', word: 'HOTDOG' },
            { emoji: 'ğŸŸ', word: 'FRIES' }, { emoji: 'ğŸš', word: 'RICE' }, { emoji: 'ğŸ¦', word: 'ICECREAM' },
            { emoji: 'ğŸ©', word: 'DONUT' }, { emoji: 'ğŸª', word: 'COOKIE' }, { emoji: 'ğŸ‚', word: 'CAKE' },
            { emoji: 'ğŸ«', word: 'CHOCOLATE' }, { emoji: 'ğŸ¬', word: 'CANDY' }, { emoji: 'ğŸ¯', word: 'HONEY' },
            { emoji: 'ğŸ¥›', word: 'MILK' },

            // Nature / Weather
            { emoji: 'ğŸŒ', word: 'SUN' }, { emoji: 'ğŸŒ™', word: 'MOON' }, { emoji: 'â­', word: 'STAR' },
            { emoji: 'â˜ï¸', word: 'CLOUD' }, { emoji: 'ğŸŒ§ï¸', word: 'RAIN' }, { emoji: 'â„ï¸', word: 'SNOW' },
            { emoji: 'ğŸ”¥', word: 'FIRE' }, { emoji: 'ğŸ’§', word: 'WATER' }, { emoji: 'ğŸŒ²', word: 'TREE' },
            { emoji: 'ğŸŒµ', word: 'CACTUS' }, { emoji: 'ğŸŒ¸', word: 'FLOWER' }, { emoji: 'ğŸŒ¹', word: 'ROSE' },
            { emoji: 'ğŸŒ»', word: 'SUNFLOWER' }, { emoji: 'ğŸ‚', word: 'LEAF' }, { emoji: 'ğŸŒ', word: 'EARTH' },

            // Transport / Objects
            { emoji: 'ğŸš—', word: 'CAR' }, { emoji: 'ğŸš•', word: 'TAXI' }, { emoji: 'ğŸšŒ', word: 'BUS' },
            { emoji: 'ğŸš²', word: 'BIKE' }, { emoji: 'ğŸš‚', word: 'TRAIN' }, { emoji: 'âœˆï¸', word: 'PLANE' },
            { emoji: 'ğŸš€', word: 'ROCKET' }, { emoji: 'ğŸš', word: 'HELICOPTER' }, { emoji: 'ğŸš¢', word: 'SHIP' },
            { emoji: 'âŒš', word: 'WATCH' }, { emoji: 'ğŸ“·', word: 'CAMERA' }, { emoji: 'ğŸ’»', word: 'COMPUTER' },
            { emoji: 'ğŸ“±', word: 'PHONE' }, { emoji: 'ğŸ“º', word: 'TV' }, { emoji: 'ğŸ“–', word: 'BOOK' },
            { emoji: 'ğŸ”‘', word: 'KEY' }, { emoji: 'ğŸ”’', word: 'LOCK' }, { emoji: 'ğŸ”¨', word: 'HAMMER' },
            { emoji: 'ğŸ', word: 'GIFT' }, { emoji: 'ğŸˆ', word: 'BALLOON' }, { emoji: 'âš½', word: 'BALL' },
            { emoji: 'ğŸ–Šï¸', word: 'PEN' }, { emoji: 'âœï¸', word: 'PENCIL' }, { emoji: 'ğŸ ', word: 'HOUSE' },

            // Body / Clothes
            { emoji: 'ğŸ‘•', word: 'SHIRT' }, { emoji: 'ğŸ‘—', word: 'DRESS' }, { emoji: 'ğŸ‘', word: 'SHOE' },
            { emoji: 'ğŸ©', word: 'HAT' }, { emoji: 'ğŸ‘“', word: 'GLASSES' }, { emoji: 'ğŸ‘€', word: 'EYE' },
            { emoji: 'ğŸ‘‚', word: 'EAR' }, { emoji: 'ğŸ‘ƒ', word: 'NOSE' }, { emoji: 'ğŸ‘„', word: 'MOUTH' },
            { emoji: 'ğŸ–ï¸', word: 'HAND' }
        ];

        const ROUND_SIZE = 20;
        let currentRoundList = [];
        let currentQuestionIndex = 0;
        let score = 0;
        
        let currentQuestionData = {};
        let guessedLetters = [];
        let isQuestionComplete = false;
        let isGameFinished = false;

        const alphabet = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";

        const emojiEl = document.getElementById('emoji');
        const wordContainer = document.getElementById('wordContainer');
        const keyboardEl = document.getElementById('keyboard');
        const scoreEl = document.getElementById('score');
        const totalRoundEl = document.getElementById('totalRound');
        const successMark = document.getElementById('successMark');
        const actionBtn = document.getElementById('actionBtn');
        const resultMessageEl = document.getElementById('resultMessage');

        // åˆå§‹åŒ–
        initGame();

        function initGame() {
            // ã€éŸ³æ•ˆ 0ã€‘ æ¸¸æˆå¼€å§‹/é‡æ–°å¼€å§‹
            sounds.start();

            const shuffledBank = [...fullQuestionBank];
            shuffleArray(shuffledBank);
            currentRoundList = shuffledBank.slice(0, ROUND_SIZE);

            currentQuestionIndex = 0;
            score = 0;
            isGameFinished = false;
            
            scoreEl.innerText = '0';
            totalRoundEl.innerText = ROUND_SIZE;
            actionBtn.innerText = "è·³è¿‡ â”";
            actionBtn.classList.remove('restart');
            actionBtn.onclick = handleAction;
            resultMessageEl.style.display = 'none';
            wordContainer.style.display = 'flex';
            keyboardEl.style.display = 'flex';

            loadQuestion(currentQuestionIndex);
        }

        function loadQuestion(index) {
            if (index >= ROUND_SIZE) {
                finishGame();
                return;
            }

            isQuestionComplete = false;
            successMark.classList.remove('show');
            currentQuestionData = currentRoundList[index];
            
            guessedLetters = new Array(currentQuestionData.word.length).fill(false);
            
            emojiEl.textContent = currentQuestionData.emoji;
            actionBtn.innerText = "è·³è¿‡ â”";
            
            renderWordSlots();
            renderKeyboard();
        }

        function handleAction() {
            if (isGameFinished) {
                initGame();
            } else {
                skipQuestion();
            }
        }

        function skipQuestion() {
            if (isQuestionComplete) return;
            currentQuestionIndex++;
            loadQuestion(currentQuestionIndex);
        }

        function checkWin() {
            if (!guessedLetters.includes(false)) {
                isQuestionComplete = true;
                score++;
                scoreEl.innerText = score;
                
                // ã€éŸ³æ•ˆ 3ã€‘ ç­”å¯¹ä¸€é¢˜
                sounds.success();

                successMark.classList.add('show');
                
                setTimeout(() => {
                    currentQuestionIndex++;
                    loadQuestion(currentQuestionIndex);
                }, 1500);
            }
        }

        function finishGame() {
            isGameFinished = true;
            
            // ã€éŸ³æ•ˆ 4ã€‘ å®Œæˆä¸€è½® (æ’­æ”¾èƒœåˆ©éŸ³ä¹)
            sounds.win();

            emojiEl.textContent = "ğŸ†";
            successMark.classList.remove('show');
            
            wordContainer.style.display = 'none';
            keyboardEl.style.display = 'none';
            
            resultMessageEl.style.display = 'block';
            
            let message = "";
            if(score === ROUND_SIZE) message = "å¤ªæ£’äº†ï¼å…¨å¯¹ï¼ğŸ’¯";
            else if(score > ROUND_SIZE * 0.8) message = "éå¸¸ä¼˜ç§€ï¼ğŸŒŸ";
            else if(score > ROUND_SIZE * 0.5) message = "åšå¾—ä¸é”™ï¼ğŸ‘";
            else message = "ç»§ç»­åŠ æ²¹ï¼ğŸ’ª";

            resultMessageEl.innerHTML = `${message}<br>æœ€ç»ˆå¾—åˆ†: ${score} / ${ROUND_SIZE}`;

            actionBtn.innerText = "ğŸ”„ é‡æ–°å¼€å§‹";
            actionBtn.classList.add('restart');
        }

        function renderWordSlots() {
            wordContainer.innerHTML = '';
            for (let i = 0; i < currentQuestionData.word.length; i++) {
                const slot = document.createElement('div');
                slot.className = 'letter-slot';
                slot.textContent = guessedLetters[i] ? currentQuestionData.word[i] : '';
                wordContainer.appendChild(slot);
            }
        }

        function renderKeyboard() {
            keyboardEl.innerHTML = '';
            const answerLetters = new Set(currentQuestionData.word.split(''));
            const n = currentQuestionData.word.length;
            const totalKeys = Math.max(n + 4, Math.floor(n * 1.8)); 
            
            const keyboardSet = new Set(answerLetters);
            while (keyboardSet.size < totalKeys) {
                const randomChar = alphabet[Math.floor(Math.random() * alphabet.length)];
                keyboardSet.add(randomChar);
            }
            
            const keyboardArray = Array.from(keyboardSet);
            shuffleArray(keyboardArray);

            keyboardArray.forEach(char => {
                const btn = document.createElement('button');
                btn.className = 'key-btn';
                btn.textContent = char;
                btn.onclick = () => handleKeyClick(btn, char);
                keyboardEl.appendChild(btn);
            });
        }

        function handleKeyClick(btn, char) {
            if (isQuestionComplete || isGameFinished) return;
            
            // è§¦å‘ Web Audio API (æµè§ˆå™¨è¦æ±‚å¿…é¡»å…ˆæœ‰äº¤äº’æ‰èƒ½æ’­æ”¾å£°éŸ³ï¼Œæ‰€ä»¥ç¬¬ä¸€æ¬¡ç‚¹å‡»å¯èƒ½æ²¡å£°éŸ³ï¼Œä¹‹åå°±å¥½äº†)
            if (audioContext.state === 'suspended') {
                audioContext.resume();
            }

            const targetWord = currentQuestionData.word;
            
            if (targetWord.includes(char)) {
                // ã€éŸ³æ•ˆ 1ã€‘ æŒ‰å¯¹å­—æ¯
                sounds.correct();

                btn.classList.add('correct');
                let anyUpdate = false;
                for (let i = 0; i < targetWord.length; i++) {
                    if (targetWord[i] === char && !guessedLetters[i]) {
                        guessedLetters[i] = true;
                        anyUpdate = true;
                    }
                }
                if (anyUpdate) {
                    renderWordSlots();
                    checkWin();
                }
            } else {
                // ã€éŸ³æ•ˆ 2ã€‘ æŒ‰é”™å­—æ¯
                sounds.wrong();
                btn.classList.add('wrong');
            }
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

    </script>
</body>
</html>